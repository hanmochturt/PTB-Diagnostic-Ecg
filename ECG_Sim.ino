#include <Wire.h>
#include <Adafruit_MCP4725.h>

Adafruit_MCP4725 dac;
const PROGMEM uint16_t d2[] = 
{1068,1052,1050,1041,1026,1027,1027,1032,1046,1053,1067,1082,1078,1081,1082,1075,1081,1082,1077,1080,1069,1066,1069,1054,1046,1038,1029,1039,1046,1049,1062,1067,1064,1059,1043,1030,1019,996,989,987,985,998,1003,1005,1015,1007,1003,1003,987,984,986,985,994,991,992,1005,1006,1007,1016,1012,1010,1012,1007,1015,1016,1001,993,980,972,978,969,961,964,966,988,1009,1017,1027,1030,1031,1042,1034,1023,1017,1000,992,988,971,966,962,947,944,931,918,920,910,912,931,941,954,963,961,969,970,969,978,977,974,978,969,963,960,949,943,934,928,953,973,986,1008,1019,1037,1056,1052,1051,1043,1029,1030,1021,1016,1030,1043,1050,1065,1075,1099,1118,1121,1132,1137,1137,1152,1157,1159,1173,1176,1183,1196,1195,1201,1201,1194,1198,1192,1183,1188,1181,1170,1159,1135,1120,1106,1072,1043,1021,999,994,989,981,982,967,960,955,928,910,898,884,885,878,872,879,882,888,896,884,875,872,862,862,852,830,821,810,801,800,780,762,746,720,714,710,700,708,728,771,867,1004,1203,1472,1792,2166,2569,2973,3375,3719,3959,4095,4093,3960,3722,3376,2971,2531,2073,1657,1296,1002,800,670,611,621,652,702,768,820,861,882,878,878,872,855,853,847,840,846,837,844,856,857,879,900,916,947,968,983,1001,997,990,988,978,978,988,990,1009,1025,1033,1049,1045,1031,1026,1009,999,1001,1001,1019,1043,1066,1098,1116,1127,1141,1140,1139,1139,1130,1136,1153,1170,1198,1213,1225,1259,1291,1324,1369,1407,1447,1483,1500,1518,1525,1509,1495,1466,1440,1428,1408,1400,1410,1416,1434,1452,1459,1476,1488,1488,1492,1481,1465,1455,1432,1415,1401,1379,1369,1352,1319,1296,1267,1239,1222,1196,1176,1163,1138,1120,1102,1081,1070,1059,1033,1015,990,966,952,921,898,884,865,863,861,857,865,858,847,845,825,807,793,768,762,767,773,788,797,800,816,819,813,810,790,777,776,772,789,807,819,846,858,866,882,876,868,867,863,868,872,867,880,890,890,899,899,898,905,901,904,911,906,916,924};
unsigned long dt = 0, tp = 0;
int i = 0, t, tamd2, FC = 70, ecg;

void setup() {
  
  Serial.begin(115200);
  dac.begin(0x60);
  tamd2 = sizeof(d2)/sizeof(d2[0]);

}

void loop() {
  
  t = (((double)60/FC)/tamd2)*1000000L;
  dt = micros() - tp;
  if (dt >= t && i < tamd2){
    tp = micros();
    ecg = pgm_read_word(&d2[i]);
    dac.setVoltage(ecg,false);
    //Serial.println(eseg);
    i++;
    if (i >= tamd2) i = 0;
  }

}